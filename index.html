<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ultimate Hypnosis Master</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-color: #050505;
            color: #e0e0e0;
            font-family: 'Inter', -apple-system, sans-serif;
            overflow: hidden;
            touch-action: manipulation;
        }
        .spiral-container {
            perspective: 1000px;
            height: 40vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .spiral {
            width: 200px;
            height: 200px;
            border: 4px solid #3b82f6;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 3s linear infinite;
            box-shadow: 0 0 50px rgba(59, 130, 246, 0.3);
        }
        @keyframes spin {
            from { transform: rotate(0deg) scale(1); }
            to { transform: rotate(360deg) scale(1.1); }
        }
        .pulse {
            animation: pulse-animation 2s infinite ease-in-out;
        }
        @keyframes pulse-animation {
            0% { opacity: 0.6; transform: scale(0.98); }
            50% { opacity: 1; transform: scale(1); }
            100% { opacity: 0.6; transform: scale(0.98); }
        }
        .glass {
            background: rgba(20, 20, 20, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .hidden-step { display: none; }
        #status-indicator {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #3b82f6;
        }
    </style>
</head>
<body class="flex flex-col h-screen p-6">

    <!-- Header Section -->
    <div class="flex justify-between items-center mb-4">
        <div id="status-indicator" class="pulse">System bereit</div>
        <div class="text-xs opacity-50">v2.5 Hybrid Induction</div>
    </div>

    <!-- Main Experience Area -->
    <div id="experience-container" class="flex-grow flex flex-col justify-center items-center text-center space-y-8">
        
        <!-- Visual Focus -->
        <div id="visual-focal" class="spiral-container">
            <div class="spiral"></div>
        </div>

        <!-- Content Steps -->
        <div id="step-1" class="space-y-4">
            <h1 class="text-2xl font-bold tracking-tight">Eintritt in die Trance</h1>
            <p class="text-gray-400 text-sm leading-relaxed">
                Fixiere den blauen Ring. Während du atmest, und die Farben beobachtest, wirst du bemerken, wie deine Augenlider schwerer werden... genau so.
            </p>
            <button onclick="nextStep(2)" class="w-full py-4 bg-blue-600 rounded-xl font-bold shadow-lg active:scale-95 transition-transform">
                START INDUCTION
            </button>
        </div>

        <div id="step-2" class="hidden-step space-y-4">
            <h1 class="text-2xl font-bold tracking-tight">Fraktionierte Vertiefung</h1>
            <p class="text-gray-400 text-sm leading-relaxed italic">
                "Schließe jetzt deine Augen... und wenn ich es sage, öffnest du sie kurz und schließt sie wieder, um doppelt so tief zu sinken."
            </p>
            <div class="flex space-x-2">
                <button onclick="triggerTTS('Induction_Deepen')" class="flex-1 py-4 bg-zinc-800 border border-zinc-700 rounded-xl text-xs uppercase font-bold tracking-widest">
                    Audio hören
                </button>
                <button onclick="nextStep(3)" class="flex-1 py-4 bg-blue-600 rounded-xl font-bold">
                    TIEFER SINKEN
                </button>
            </div>
        </div>

        <div id="step-3" class="hidden-step space-y-4">
            <h1 class="text-2xl font-bold tracking-tight text-blue-400">Trigger Installation</h1>
            <p class="text-gray-400 text-sm leading-relaxed">
                Wähle einen Anker (z.B. Daumen und Zeigefinger berühren). In diesem Moment der tiefsten Entspannung bündeln wir deine Kraft.
            </p>
            <div class="p-4 glass rounded-2xl text-left text-xs space-y-2">
                <p>1. Atme tief in den Peak-Zustand.</p>
                <p>2. Aktiviere deinen physischen Anker.</p>
                <p>3. Wiederhole mental: <strong>"Tiefer Jetzt"</strong>.</p>
            </div>
            <button onclick="nextStep(4)" class="w-full py-4 bg-indigo-600 rounded-xl font-bold">ANKER VERSIEGELN</button>
        </div>

        <div id="step-4" class="hidden-step space-y-4">
            <h1 class="text-2xl font-bold tracking-tight text-emerald-400">Manifestation (VAKOG)</h1>
            <p class="text-gray-400 text-sm leading-relaxed">
                Du siehst es bereits... du fühlst es... es ist bereits realität. Dein Ziel ist jetzt dein Zustand.
            </p>
            <textarea id="manifestation-goal" class="w-full bg-zinc-900 border border-zinc-700 rounded-xl p-4 text-sm focus:outline-none focus:border-blue-500" placeholder="Beschreibe dein Ziel im Präsens..."></textarea>
            <button onclick="finishSession()" class="w-full py-4 bg-emerald-600 rounded-xl font-bold">JETZT REALISIEREN</button>
        </div>
    </div>

    <!-- Footer Controls -->
    <div class="mt-auto glass p-4 rounded-3xl flex justify-around items-center">
        <button class="text-zinc-500 hover:text-white" onclick="resetApp()">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
            </svg>
        </button>
        <button class="text-blue-500 scale-125" onclick="togglePulse()">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 14H9V8h2v8zm4 0h-2V8h2v8z"/>
            </svg>
        </button>
        <button class="text-zinc-500" id="audio-settings-btn">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z" />
            </svg>
        </button>
    </div>

    <script>
        const apiKey = ""; // ElevenLabs API Key Platzhalter
        let currentStep = 1;

        function nextStep(step) {
            document.getElementById(`step-${currentStep}`).classList.add('hidden-step');
            document.getElementById(`step-${step}`).classList.remove('hidden-step');
            currentStep = step;
            updateStatus(step);
        }

        function updateStatus(step) {
            const status = document.getElementById('status-indicator');
            const messages = ["Bereit", "Induktion läuft", "Deepening...", "Programmierung", "Manifestiert"];
            status.innerText = messages[step - 1] || "Aktiv";
        }

        function resetApp() {
            location.reload();
        }

        async function triggerTTS(type) {
            const status = document.getElementById('status-indicator');
            status.innerText = "Stimme wird generiert...";
            
            const textMap = {
                "Induction_Deepen": "Schließe jetzt deine Augen. Spüre, wie die Entspannung von der Kopfhaut bis in die Zehenspitzen fließt. Wenn du die Augen gleich wieder öffnest und schließt, wird dein Zustand zehnmal tiefer sein als jetzt. Jetzt... öffnen... und schließen. Zehnmal tiefer sinken."
            };

            const text = textMap[type];

            if (!apiKey) {
                // Fallback: Native Browser Speech if no API Key
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'de-DE';
                utterance.rate = 0.8;
                window.speechSynthesis.speak(utterance);
                status.innerText = "Audio Aktiv (System)";
                return;
            }

            // ElevenLabs Integration (Exponential Backoff included for production readiness)
            try {
                const response = await fetch("https://api.elevenlabs.io/v1/text-to-speech/21m00Tcm4llvDq8ikWAM", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "xi-api-key": apiKey
                    },
                    body: JSON.stringify({
                        text: text,
                        model_id: "eleven_multilingual_v2",
                        voice_settings: { stability: 0.8, similarity_boost: 0.8 }
                    })
                });
                
                const audioBlob = await response.blob();
                const audioUrl = URL.createObjectURL(audioBlob);
                const audio = new Audio(audioUrl);
                audio.play();
                status.innerText = "Audio Aktiv (HQ)";
            } catch (error) {
                console.error("Audio Error:", error);
                status.innerText = "Audio Fehler";
            }
        }

        function finishSession() {
            const goal = document.getElementById('manifestation-goal').value;
            const container = document.getElementById('experience-container');
            
            // Post-hypnotic suggestion reinforcement
            const reinforcement = "Jedes Mal, wenn du diese App öffnest oder deinen Anker benutzt, wird der Zustand schneller, tiefer und mächtiger. Dein Wille ist Gesetz.";
            
            container.innerHTML = `
                <div class="space-y-6 animate-pulse">
                    <h1 class="text-4xl font-black text-white">ES IST VOLLBRACHT</h1>
                    <p class="text-blue-400 font-medium">Dein Fokus: "${goal}"</p>
                    <p class="text-gray-500 text-xs">${reinforcement}</p>
                    <div class="mt-8 text-6xl">✨</div>
                    <button onclick="resetApp()" class="mt-10 px-8 py-2 border border-zinc-700 rounded-full text-xs">ZURÜCKKEHREN</button>
                </div>
            `;
            
            // Play final reinforcement trigger
            const utterance = new SpeechSynthesisUtterance(reinforcement);
            utterance.lang = 'de-DE';
            utterance.rate = 0.85;
            window.speechSynthesis.speak(utterance);
        }

        function togglePulse() {
            const spiral = document.querySelector('.spiral');
            const isFast = spiral.style.animationDuration === '0.5s';
            spiral.style.animationDuration = isFast ? '3s' : '0.5s';
        }
    </script>
</body>
</html>
